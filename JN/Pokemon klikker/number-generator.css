.np-platinum-widget {
  --type-color: #6b6ff3;
  max-width: 760px; /* larger widget */
  margin: 2rem auto;
  border-radius: 12px;
  padding: 1.25rem;
  color: #e9eef7;
  background: linear-gradient(180deg,#0f1114 0%, #1b1520 60%);
  box-shadow: 0 6px 30px rgba(0,0,0,0.45), inset 0 1px 0 rgba(255,255,255,0.02);
  border: 1px solid rgba(255,255,255,0.02);
  transition: box-shadow 350ms ease, background 350ms ease;
  position: relative;
  overflow: hidden;
}

/* Page-level background canvas that pulses using the selected type color */
.platinum-theme { position: relative; z-index: 0; }
.platinum-theme::before {
  content: '';
  position: absolute;
  inset: -10%;
  background: radial-gradient(circle at 20% 30%, transparent, transparent), radial-gradient(circle at 80% 70%, transparent, transparent);
  opacity: 0;
  pointer-events: none;
  transition: opacity 360ms ease, transform 720ms ease;
  filter: blur(36px);
  z-index: -1;
}
.platinum-theme.page-has-type::before {
  opacity: 0.995;
  /* fallback for browsers that don't support color-mix */
  background: radial-gradient(circle at 20% 30%, var(--page-type-color) 0%, transparent 30%), radial-gradient(circle at 80% 70%, color-mix(in srgb, var(--page-type-color) 18%, transparent) 0%, transparent 38%);
  background: radial-gradient(circle at 20% 30%, color-mix(in srgb, var(--page-type-color) 40%, transparent) 0%, transparent 30%), radial-gradient(circle at 80% 70%, color-mix(in srgb, var(--page-type-color) 28%, transparent) 0%, transparent 38%);
  transform: scale(1.02);
  animation: bg-ambient 12s linear infinite;
}

@keyframes bg-ambient {
  0% { transform: scale(1) translateY(0) }
  50% { transform: scale(1.03) translateY(-2%) }
  100% { transform: scale(1) translateY(0) }
}

/* Canvas particles: subtle ambient orbs behind the widget */
.particle-canvas { position: fixed; inset: 0; width: 100%; height: 100%; z-index: -3; pointer-events: none; display:block }

/* animated radial pulse uses the selected type color via CSS var */
.np-platinum-widget.has-type::before {
  content: '';
  position: absolute;
  inset: -40%;
  /* fallback for older browsers */
  background: radial-gradient(circle at 30% 20%, color-mix(in srgb, var(--type-color) 60%, transparent), transparent 28%), radial-gradient(circle at 70% 70%, color-mix(in srgb, var(--type-color) 45%, transparent), transparent 36%);
  animation: bg-pulse 3.2s ease-in-out infinite, bg-shift 12s linear infinite;
  opacity: 0.96;
  pointer-events: none;
  mix-blend-mode: screen;
}

@keyframes bg-pulse {
  0% { transform: scale(1); opacity: 0.7 }
  50% { transform: scale(1.06); opacity: 1 }
  100% { transform: scale(1); opacity: 0.7 }
}

@keyframes bg-shift {
  0% { transform: rotate(0deg) translateX(0) }
  50% { transform: rotate(30deg) translateX(6%) }
  100% { transform: rotate(0deg) translateX(0) }
}

.np-header h2 { margin: 0 0 0.25rem 0; font-size: 1.15rem; }
.np-sub { margin: 0 0 0.75rem 0; color: #c9d1e0; font-size: 1rem }
.np-body { display:flex; flex-direction:column; align-items:center; gap: 0.75rem; position:relative; z-index:1 }
.np-number-inner { transition: transform 180ms ease }
.np-number {
  width: 160px; height:160px; font-size:3.75rem; display:flex; align-items:center; justify-content:center; border-radius:12px;
  /* fallback for browsers without color-mix support */
  background: linear-gradient(135deg, var(--type-color), #2b2336);
  border: 2px solid rgba(255,255,255,0.04);
  background: linear-gradient(135deg, color-mix(in srgb, var(--type-color) 48%, #1f2430), #2b2336);
}
.np-platinum-widget.has-type .np-number { box-shadow: 0 22px 84px color-mix(in srgb, var(--type-color) 70%, transparent), inset 0 -14px 72px rgba(0,0,0,0.45); }
.np-number.rolling { animation: roll-bounce 1.2s ease-in-out; transform: scale(1.08); }
.np-number.rolling .np-number-inner { transform: rotate(-6deg) scale(1.08) }
@keyframes roll-bounce { 0% { transform: scale(1); } 50% { transform: scale(1.08) rotate(-2deg); } 100% { transform: scale(1); } }
.np-type { display:flex; align-items:center; gap:0.6rem; color:#e6eef8 }
.np-type-dot { width:44px; height:44px; border-radius:50%; display:inline-flex; align-items:center; justify-content:center; font-size:1.2rem; color: #111; border: 2px solid rgba(255,255,255,0.08); box-shadow: 0 9px 28px rgba(0,0,0,0.55); transition: transform 220ms ease }
.np-platinum-widget.has-type .np-type-dot { transform: scale(1.1); box-shadow: 0 18px 64px color-mix(in srgb, var(--type-color) 65%, rgba(0,0,0,0.36)) }
.np-type-name { font-weight:600 }
.np-type-placeholder { color:#9aa6bd }

.np-controls { margin-top: 0.5rem }
.np-btn { background: linear-gradient(180deg,color-mix(in srgb,var(--type-color) 55%, #6b6ff3), color-mix(in srgb,var(--type-color) 28%, #4a46a8)); color: white; border: none; padding: 0.6rem 1rem; border-radius:8px; font-weight:800; cursor:pointer; box-shadow: 0 10px 28px color-mix(in srgb,var(--type-color) 45%, rgba(0,0,0,0.25)); transition: transform 120ms }
.np-btn:active { transform: translateY(1px) }
.np-footer { text-align:center; margin-top:0.6rem; color:#9fb0d8 }

@media (max-width:520px) {
  .np-number { width:120px; height:120px; font-size:2.5rem }
  .np-type-dot { width:34px; height:34px }
}

@media (max-width: 760px) {
  .np-platinum-widget { max-width: 96%; margin: 1rem; padding: 0.9rem }
  .np-body { gap: 0.5rem }
  .np-number { width: 120px; height: 120px; font-size: 2.25rem }
  .roster-controls { flex-wrap: wrap; gap: 0.5rem }
  .roster-controls .type-input, .roster-controls .poke-name { min-width: 44%; flex: 1 }
  .roster-controls .add-poke { min-width: 44% }
  .roster-boxes { flex-direction: column }
  .roster-box { min-height: 60px }
  .poke-item { padding: 0.4rem }
}

/* Roster / Nuzlocke UI */
.np-roster { margin-top: 1rem; display:flex; flex-direction:column; gap:0.6rem; z-index:1 }
.roster-controls { display:flex; gap:0.5rem; align-items:center }
.roster-controls input, .roster-controls select { padding:0.45rem; border-radius:6px; border:1px solid rgba(255,255,255,0.04); background: rgba(255,255,255,0.02); color:inherit }
.roster-controls .add-poke { padding:0.45rem 0.7rem; border-radius:6px; background: linear-gradient(180deg,#1e6b2e,#154f22); color:white; border:none; cursor:pointer; font-weight:700 }
.roster-controls .add-poke:disabled { opacity:0.6; transform: translateY(1px) }
.roster-controls .faint-selected { padding:0.45rem 0.7rem; border-radius:6px; background: linear-gradient(180deg,#6b1e1e,#4a1212); color:white; border:none; cursor:pointer; font-weight:700 }
.roster-controls .faint-selected:disabled { opacity:0.6; transform: translateY(1px) }
/* Type input and autosuggest dropdown */
.type-input { min-width:110px; padding:0.45rem; border-radius:6px; border:1px solid rgba(255,255,255,0.04); background: rgba(255,255,255,0.02); color:inherit }
.type-suggest { position: absolute; z-index: 9999; min-width:140px; padding:6px; border-radius:8px; background: rgba(8,10,12,0.96); box-shadow: 0 8px 28px rgba(0,0,0,0.7); max-height:220px; overflow-y:auto }
.type-suggest-item { padding:6px 8px; border-radius:6px; cursor:pointer; color: #dce6f8 }
.type-suggest-item:hover { filter: brightness(0.95); transform: translateY(-1px) }
.type-suggest-item.selected { outline: 2px solid rgba(255,255,255,0.06); box-shadow: 0 8px 22px rgba(0,0,0,0.6); transform: translateY(-1px) }
.roster-boxes { display:flex; gap:0.8rem; margin-top:0.6rem }
.roster-box { flex:1; background: rgba(0,0,0,0.85); border-radius:8px; padding:0.6rem; min-height:80px; border: 1px solid rgba(255,255,255,0.03) }
.roster-box { display:flex; flex-direction:column; flex:1; background: rgba(0,0,0,0.85); border-radius:8px; padding:0.6rem; min-height:80px; border: 1px solid rgba(255,255,255,0.03) }
.roster-box h3 { margin:0 0 0.45rem 0; font-size:0.95rem }
.roster-box .list { padding:6px; overflow-y:auto; max-height:260px }
/* subtle scrollbars (WebKit / Blink) */
.roster-box .list::-webkit-scrollbar { width:10px; height:10px }
.roster-box .list::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.04); border-radius:8px }
.roster-box .list::-webkit-scrollbar-track { background: transparent }
.poke-item.jump { box-shadow: 0 18px 54px rgba(255,255,255,0.04); transform: translateY(-6px); transition: transform 300ms ease, box-shadow 300ms ease }
/* make sure lists can be focused for keyboard navigation */
.roster-box .list:focus { outline: 2px dashed rgba(255,255,255,0.04) }
.poke-item {
  padding:0.45rem 0.6rem;
  border-radius:6px;
  margin-bottom:0.45rem;
  cursor:pointer;
  display:flex;
  justify-content:space-between;
  align-items:center;
  background: rgba(0,0,0,0.6);
  border: 1px solid rgba(255,255,255,0.02);
  transition: transform .12s ease, box-shadow .12s ease;
}
.poke-item:hover { transform: translateY(-3px); box-shadow: 0 8px 22px rgba(0,0,0,0.45) }
.poke-item .name { font-weight:700 }
.poke-item .types { display:flex; gap:0.35rem; font-size:0.85rem; opacity:0.95 }

/* hover: color the name and type chips using the primary type color set on the item */
.poke-item .name, .poke-item .type-chip { transition: color 180ms ease, text-shadow 220ms ease, transform 160ms ease }
.poke-item:hover .name, .poke-item:hover .type-chip { color: var(--primary-color, #fff); text-shadow: 0 8px 28px var(--primary-rgba, rgba(255,255,255,0.06)); transform: translateY(-2px) }

/* make alive items more vibrant; dead items more muted but still show their color */
.roster-box.alive .poke-item { filter: none; opacity: 1 }
.roster-box.dead .poke-item { filter: grayscale(.08); opacity: 0.92 }
.roster-box.dead .poke-item .type-chip { filter: saturate(0.9) }

.type-chip { display:inline-flex; align-items:center; gap:6px; padding:4px 8px; border-radius:6px; font-weight:600; transition: transform .12s ease, box-shadow .12s ease, background 160ms ease, color 160ms ease; cursor:default }
.type-chip:hover { transform: translateY(-2px); filter: brightness(0.98); background: var(--chip-rgba); color: var(--chip-color) }

.poke-item.selected { outline: 3px solid rgba(255,255,255,0.06); box-shadow: 0 12px 30px rgba(0,0,0,0.6); transform: translateY(-2px) }
.roster-box.dead { border: 1px dashed rgba(255,255,255,0.04) }
.roster-box.dead.drop-over { box-shadow: 0 8px 28px rgba(200,20,20,0.12); border-color: rgba(255,80,80,0.6) }

/* Toast background message (appears behind content, not modal) */
.bg-toast { position: absolute; left: 8%; right: 8%; top: 8%; padding: 0.8rem 1rem; border-radius: 8px; text-align:center; z-index: -1; transform: translateY(-10px); opacity: 0; pointer-events:none; transition: opacity 360ms ease, transform 360ms ease }
.bg-toast.show { opacity: 0.98; transform: translateY(0); z-index: 2 }
.bg-toast.success { background: linear-gradient(90deg, rgba(44,160,44,0.95), rgba(20,120,20,0.9)); color: white }
.bg-toast.fail { background: linear-gradient(90deg, rgba(180,44,44,0.95), rgba(120,20,20,0.9)); color: white }
.bg-toast.info { background: linear-gradient(90deg, rgba(60,60,90,0.95), rgba(30,30,60,0.9)); color: white }

/* Number lighting when type chosen */
.np-number.lit { transition: box-shadow 300ms ease, color 300ms ease, transform 300ms ease }
.np-number.lit .np-number-inner { transform: scale(1.06); }
.encounter-overlay { position: fixed; inset:0; display:flex; align-items:center; justify-content:center; z-index:9999; pointer-events:auto }
.encounter-overlay .panel { background: #0b0c10; padding:1rem; border-radius:10px; width:min(520px,95%); box-shadow: 0 10px 40px rgba(0,0,0,0.7) }
.encounter-overlay .panel .matches { max-height:240px; overflow:auto; margin:0.5rem 0 }
.encounter-overlay .panel button { margin-right:0.6rem }
.encounter-overlay .panel input, .encounter-overlay .panel select { padding:0.45rem; border-radius:6px; border:1px solid rgba(255,255,255,0.04); background: rgba(255,255,255,0.02); color:inherit }

/* font */
body { font-family: 'Poppins', Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial }
